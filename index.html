<!DOCTYPE html>
<html>
<head>
    <title>Leaflet.heat demo</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css"
      integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ=="
      crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js"
      integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log=="
      crossorigin=""></script>
    <style>
      body { margin:0; padding:0; }
      #map { position:absolute; top:0; bottom:0; width:100%; }
    </style>
</head>
<body>

<div id="map"></div>

<script src="leaflet-heat.js"></script>
<script src="https://d3js.org/d3.v4.min.js" charset="utf-8"></script>
<script>

var map = L.map('map').setView([21.546336, 72.990182], 9);
L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
		maxZoom: 18,
		attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
			'<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
			'Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
		id: 'mapbox.streets'
	}).addTo(map);
var heat;
var zzz;
var url = 'https://raw.githubusercontent.com/SupervisionT/heatmap/master/vikqxm6%202017-06-20.csv'
d3.csv(url, function(data) {
  var speed = data.map(function(c){ return Number(c.ground_speed) })
  var max = d3.max(speed, function(d) {return d })
  var min = d3.min(speed, function(d) {return d })
  var scale = d3.scale.linear()
                    .domain([min, max])
                    .range([max, min]);
  zzz = data.map((x) => {
    return [Number(x.latitude), Number(x.longitude), scale(Number(x.ground_speed))]
  })
  var bounds = new L.LatLngBounds(zzz);
  map.fitBounds(bounds);
  var options= {
                maxZoom: 18,
                radius: 20,
                blur: 15,
                max: 1.0
                // gradient: {0.4: 'blue', 0.65: 'lime', 1: 'red'}
                }
  heat = L.heatLayer(zzz, options).addTo(map);
});
</script>
</body>
</html>
